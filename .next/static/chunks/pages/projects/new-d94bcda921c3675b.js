(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[689],{3598:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/projects/new",function(){return a(3686)}])},3686:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var n=a(5893),s=a(7294),r=a(7066),l=a(1163);let c="http://localhost:4000";function o(e){let{session:t}=e,[a,o]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[u,p]=(0,s.useState)([]),[h,m]=(0,s.useState)([]),x=(0,l.useRouter)();async function j(){let e=localStorage.getItem("backend_token"),t=await r.Z.get("".concat(c,"/api/works"),{headers:{Authorization:"Bearer ".concat(e)}});p(t.data)}async function f(e){e.preventDefault();let t=localStorage.getItem("backend_token");await r.Z.post("".concat(c,"/api/projects"),{project_name:a,project_address:i,works:h.map(e=>({work_id:e.work_id,quantity:e.quantity}))},{headers:{Authorization:"Bearer ".concat(t)}}),x.push("/projects")}return(0,s.useEffect)(()=>{t&&j()},[t]),t?(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h1",{className:"text-xl font-bold mb-4",children:"Create New Project"}),(0,n.jsxs)("form",{onSubmit:f,className:"space-y-4 mb-4",children:[(0,n.jsx)("input",{type:"text",placeholder:"Project Name",className:"border p-2 w-full",value:a,onChange:e=>o(e.target.value)}),(0,n.jsx)("input",{type:"text",placeholder:"Project Address",className:"border p-2 w-full",value:i,onChange:e=>d(e.target.value)}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"font-bold mb-2",children:"Add Works"}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:u.map(e=>(0,n.jsx)("button",{type:"button",className:"bg-gray-200 px-2 py-1 rounded",onClick:()=>{h.find(t=>t.work_id===e.id)||m([...h,{work_id:e.id,name:e.name,quantity:0}])},children:e.name},e.id))}),(0,n.jsxs)("table",{className:"min-w-full bg-white",children:[(0,n.jsx)("thead",{className:"bg-gray-200",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"p-2 text-left",children:"Work"}),(0,n.jsx)("th",{className:"p-2 text-left",children:"Quantity (User Input)"})]})}),(0,n.jsx)("tbody",{children:h.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"p-2",children:e.name}),(0,n.jsx)("td",{className:"p-2",children:(0,n.jsx)("input",{type:"number",className:"border p-1 w-full",value:e.quantity,onChange:t=>{var a,n;return a=e.work_id,n=t.target.value,void m(h.map(e=>e.work_id===a?{...e,quantity:parseFloat(n)}:e))}})})]},e.work_id))})]})]}),(0,n.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded",type:"submit",children:"Create Project"})]})]}):(0,n.jsx)("div",{children:"Loading..."})}}},function(e){e.O(0,[66,774,888,179],function(){return e(e.s=3598)}),_N_E=e.O()}]);